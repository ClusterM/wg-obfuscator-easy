openapi: 3.0.3
info:
  title: WireGuard Obfuscator Easy API
  description: |
    REST API for managing WireGuard VPN server with obfuscation support.
    Provides endpoints for authentication, client management, server configuration,
    statistics, and monitoring.
  version: 1.0.0
  contact:
    name: Alexey Cluster
    email: cluster@cluster.wtf
  license:
    name: GPL-3.0
    url: https://www.gnu.org/licenses/gpl-3.0.html

servers:
  - url: http://localhost:5000
    description: Local development server
  - url: /{webPrefix}
    description: Production server with web prefix
    variables:
      webPrefix:
        default: ""
        description: Optional web prefix (e.g., /vpn)

tags:
  - name: Authentication
    description: Authentication and user management endpoints
  - name: Clients
    description: WireGuard client management
  - name: Configuration
    description: Server configuration management
  - name: Statistics
    description: Server and client statistics
  - name: Health
    description: Health check endpoints
  - name: System
    description: System configuration and management

paths:
  /health:
    get:
      tags:
        - Health
      summary: Health check
      description: Check if the service is running
      operationId: healthCheck
      responses:
        '200':
          description: Service is healthy
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: ok

  /api/system/timezone:
    get:
      tags:
        - System
      summary: Get system timezone
      description: Get current system timezone setting
      operationId: getSystemTimezone
      security:
        - bearerAuth: []
      responses:
        '200':
          description: System timezone information
          content:
            application/json:
              schema:
                type: object
                properties:
                  timezone:
                    type: string
                    description: Current system timezone (e.g., Europe/Moscow, UTC)
                    example: Europe/Moscow
                  offset:
                    type: string
                    description: UTC offset (e.g., +03:00, +00:00)
                    example: +03:00
                  available_timezones:
                    type: array
                    items:
                      type: string
                    description: List of available timezones
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
    patch:
      tags:
        - System
      summary: Set system timezone
      description: Change system timezone setting
      operationId: setSystemTimezone
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - timezone
              properties:
                timezone:
                  type: string
                  description: New timezone (must be a valid timezone identifier)
                  example: Europe/Moscow
      responses:
        '200':
          description: Timezone updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Timezone updated successfully
                  timezone:
                    type: string
                    example: Europe/Moscow
                  offset:
                    type: string
                    example: +03:00
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/system/restart:
    post:
      tags:
        - System
      summary: Restart system
      description: Gracefully restart the application to apply configuration changes
      operationId: restartSystem
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Restart initiated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: System restart initiated. The application will restart automatically.
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/auth/login:
    post:
      tags:
        - Authentication
      summary: Login
      description: |
        Authenticate and receive an access token.
        Rate limited to 5 attempts per minute per IP address.
      operationId: login
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - username
                - password
              properties:
                username:
                  type: string
                  description: Admin username
                password:
                  type: string
                  format: password
                  description: Admin password
      responses:
        '200':
          description: Successful authentication
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthToken'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '429':
          description: Too many login attempts
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/auth/status:
    get:
      tags:
        - Authentication
      summary: Get authentication status
      description: Check if authentication is enabled
      operationId: getAuthStatus
      responses:
        '200':
          description: Authentication status
          content:
            application/json:
              schema:
                type: object
                properties:
                  enabled:
                    type: boolean
                    description: Whether authentication is enabled

  /api/auth/credentials:
    get:
      tags:
        - Authentication
      summary: Get admin credentials
      description: Get admin username (password is not returned)
      operationId: getCredentials
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Admin username
          content:
            application/json:
              schema:
                type: object
                properties:
                  username:
                    type: string
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/auth/change-password:
    post:
      tags:
        - Authentication
      summary: Change admin password
      description: Change admin password. All existing tokens will be revoked.
      operationId: changePassword
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - old_password
                - new_password
              properties:
                old_password:
                  type: string
                  format: password
                new_password:
                  type: string
                  format: password
      responses:
        '200':
          description: Password changed successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/auth/change-credentials:
    post:
      tags:
        - Authentication
      summary: Change admin credentials
      description: Change admin username and/or password. All existing tokens will be revoked.
      operationId: changeCredentials
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                new_username:
                  type: string
                  description: New admin username (optional)
                old_password:
                  type: string
                  format: password
                  description: Current password (required if changing password)
                new_password:
                  type: string
                  format: password
                  description: New password (required if changing password)
      responses:
        '200':
          description: Credentials changed successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/clients:
    get:
      tags:
        - Clients
      summary: List all clients
      description: Get list of all WireGuard clients with connection statistics
      operationId: getClients
      security:
        - bearerAuth: []
      responses:
        '200':
          description: List of clients
          content:
            application/json:
              schema:
                type: object
                additionalProperties:
                  $ref: '#/components/schemas/Client'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
    post:
      tags:
        - Clients
      summary: Create new client
      description: Create a new WireGuard client
      operationId: createClient
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - username
              properties:
                username:
                  type: string
                  description: Client username
                obfuscation:
                  type: boolean
                  default: true
                  description: Enable obfuscation for this client
                enabled:
                  type: boolean
                  default: true
                  description: Enable client
      responses:
        '201':
          description: Client created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Client'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/clients/{username}:
    get:
      tags:
        - Clients
      summary: Get client details
      description: Get detailed information about a specific client
      operationId: getClient
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/Username'
      responses:
        '200':
          description: Client information
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Client'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
    patch:
      tags:
        - Clients
      summary: Update client
      description: Update client configuration
      operationId: updateClient
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/Username'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                allowed_ips:
                  type: array
                  items:
                    type: string
                    pattern: '^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/[0-9]{1,2}$'
                  description: Allowed IP addresses in CIDR format
                obfuscator_port:
                  type: integer
                  nullable: true
                  minimum: 1
                  maximum: 65535
                  description: Custom obfuscator port (null to use default)
                masking_type_override:
                  type: string
                  nullable: true
                  enum: [none, obfs4, scramblesuit]
                  description: Override masking type for this client (null to use server default)
                verbosity_level:
                  type: string
                  enum: [0, 1, 2, 3, 4]
                  description: Verbosity level (0-4)
                enabled:
                  type: boolean
                  description: Enable/disable client
      responses:
        '200':
          description: Client updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Client'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
    delete:
      tags:
        - Clients
      summary: Delete client
      description: Delete a WireGuard client
      operationId: deleteClient
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/Username'
      responses:
        '200':
          description: Client deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/clients/{username}/regenerate-keys:
    post:
      tags:
        - Clients
      summary: Regenerate client keys
      description: Generate new key pair for a client
      operationId: regenerateClientKeys
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/Username'
      responses:
        '200':
          description: Keys regenerated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  private_key:
                    type: string
                  public_key:
                    type: string
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/clients/{username}/config/wireguard:
    get:
      tags:
        - Clients
      summary: Get WireGuard configuration
      description: Download WireGuard configuration file for a client
      operationId: getClientWireGuardConfig
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/Username'
      responses:
        '200':
          description: WireGuard configuration file
          content:
            text/plain:
              schema:
                type: string
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/clients/{username}/config/obfuscator:
    get:
      tags:
        - Clients
      summary: Get obfuscator configuration
      description: Download obfuscator configuration file for a client
      operationId: getClientObfuscatorConfig
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/Username'
      responses:
        '200':
          description: Obfuscator configuration file
          content:
            text/plain:
              schema:
                type: string
        '400':
          description: Obfuscation is disabled
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/config:
    get:
      tags:
        - Configuration
      summary: Get server configuration
      description: Get current server settings (read-only)
      operationId: getConfig
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Server configuration
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerConfig'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
    patch:
      tags:
        - Configuration
      summary: Update server configuration
      description: Update server configuration parameters
      operationId: updateConfig
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                subnet:
                  type: string
                  pattern: '^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.0/24$'
                  description: Server subnet in CIDR format (X.Y.Z.0/24)
                obfuscation:
                  type: boolean
                  description: Enable/disable obfuscation
                obfuscation_key:
                  type: string
                  maxLength: 300
                  description: Obfuscation key (ASCII only, max 300 characters)
                obfuscator_verbosity:
                  type: string
                  enum: [0, 1, 2, 3, 4]
                  description: Obfuscator verbosity level (0-4)
                verbosity_level:
                  type: string
                  enum: [0, 1, 2, 3, 4]
                  description: Obfuscator verbosity level (0-4), alias for obfuscator_verbosity
                masking_type:
                  type: string
                  enum: [none, obfs4, scramblesuit]
                  description: Masking type
                masking_forced:
                  type: boolean
                  description: Force masking type for all clients
                enabled:
                  type: boolean
                  description: Enable/disable WireGuard server
      responses:
        '200':
          description: Configuration updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerConfig'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/config/regenerate-keys:
    post:
      tags:
        - Configuration
      summary: Regenerate server keys
      description: Generate new server key pair
      operationId: regenerateServerKeys
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Keys regenerated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  server_public_key:
                    type: string
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/status:
    get:
      tags:
        - Statistics
      summary: Get server status
      description: Get server status including WireGuard and obfuscator status
      operationId: getStatus
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Server status
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerStatus'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/stats:
    get:
      tags:
        - Statistics
      summary: Get WireGuard statistics
      description: Get WireGuard statistics for all peers
      operationId: getStats
      security:
        - bearerAuth: []
      responses:
        '200':
          description: WireGuard statistics
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WireGuardStats'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
        '503':
          description: WireGuard interface not found or not running
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/stats/{username}:
    get:
      tags:
        - Statistics
      summary: Get client statistics
      description: Get WireGuard statistics for a specific client
      operationId: getClientStats
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/Username'
      responses:
        '200':
          description: Client statistics
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PeerStats'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
        '503':
          description: WireGuard interface not found or not running
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/logs/obfuscator:
    get:
      tags:
        - Statistics
      summary: Get obfuscator logs
      description: Get last N lines from in-memory obfuscator logs
      operationId: getObfuscatorLogs
      security:
        - bearerAuth: []
      parameters:
        - name: lines
          in: query
          description: Number of lines to return
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 10000
            default: 100
      responses:
        '200':
          description: Obfuscator logs
          content:
            application/json:
              schema:
                type: object
                properties:
                  lines:
                    type: array
                    items:
                      type: string
                  total_lines:
                    type: integer
                  requested_lines:
                    type: integer
                  returned_lines:
                    type: integer
                  message:
                    type: string
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/metrics/system:
    get:
      tags:
        - Statistics
      summary: Get system metrics
      description: Return service state metrics formatted for Prometheus.
      operationId: getMetricsSystem
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Prometheus-formatted metrics
          content:
            text/plain:
              schema:
                type: string
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/metrics/clients:
    get:
      tags:
        - Statistics
      summary: Get metrics for all clients
      description: Return connection and traffic counters for all clients in Prometheus format.
      operationId: getMetricsClients
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Prometheus-formatted client metrics
          content:
            text/plain:
              schema:
                type: string
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/metrics/clients/{username}:
    get:
      tags:
        - Statistics
      summary: Get metrics for a specific client
      description: Return Prometheus-formatted metrics for a single client.
      operationId: getMetricsClient
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/Username'
      responses:
        '200':
          description: Prometheus-formatted metrics
          content:
            text/plain:
              schema:
                type: string
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/metrics/all:
    get:
      tags:
        - Statistics
      summary: Get all metrics (system + all clients)
      description: Return all Prometheus-formatted metrics combining system metrics and all client metrics in a single response.
      operationId: getMetricsAll
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Prometheus-formatted metrics (system + all clients)
          content:
            text/plain:
              schema:
                type: string
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/metrics/token:
    get:
      tags:
        - Statistics
      summary: Get metrics token
      description: Returns the current metrics token if it exists.
      operationId: getMetricsToken
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Metrics token (or null if not set)
          content:
            application/json:
              schema:
                type: object
                properties:
                  token:
                    type: string
                    nullable: true
                    description: Metrics authentication token (null if not set)
                    example: "a1b2c3d4e5f6..."
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
    post:
      tags:
        - Statistics
      summary: Generate metrics token
      description: Generate a new token for accessing the metrics endpoints. Replaces any existing token.
      operationId: generateMetricsToken
      security:
        - bearerAuth: []
      responses:
        '200':
          description: New metrics token generated
          content:
            application/json:
              schema:
                type: object
                properties:
                  token:
                    type: string
                    description: Newly generated metrics token
                    example: "a1b2c3d4e5f6..."
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
    delete:
      tags:
        - Statistics
      summary: Delete metrics token
      description: Delete the metrics authentication token.
      operationId: deleteMetricsToken
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Token deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Metrics token deleted successfully
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: |
        Bearer token authentication. For most endpoints, use JWT token obtained from the /api/auth/login endpoint.
        For metrics endpoints (/api/metrics/*), you can use either a JWT token or the dedicated metrics token (obtained from /api/metrics/token).
        Include the token in the Authorization header as: "Bearer <token>"

  parameters:
    Username:
      name: username
      in: path
      required: true
      description: Client username
      schema:
        type: string

  schemas:
    Error:
      type: object
      properties:
        error:
          type: string
          description: Error message

    AuthToken:
      type: object
      properties:
        access_token:
          type: string
          description: OAuth 2.0 access token
        token_type:
          type: string
          example: Bearer
        expires_in:
          type: integer
          description: Token expiration time in seconds

    Client:
      type: object
      properties:
        username:
          type: string
        ip:
          type: integer
          description: Numeric host identifier (last octet) assigned to the client
        ip_full:
          type: string
          format: ipv4
          description: Full IPv4 address assigned to the client
        public_key:
          type: string
        private_key:
          type: string
        allowed_ips:
          type: array
          items:
            type: string
          description: Allowed IP addresses in CIDR format
        obfuscator_port:
          type: integer
          nullable: true
          description: Custom obfuscator port (null means default)
        masking_type_override:
          type: string
          nullable: true
          enum: [none, obfs4, scramblesuit]
          description: Override masking type for this client
        verbosity_level:
          type: string
          nullable: true
          enum: [0, 1, 2, 3, 4]
          description: Obfuscator verbosity level for this client
        enabled:
          type: boolean
          description: Whether client is enabled
        is_connected:
          type: boolean
          description: Whether client is currently connected
        latest_handshake:
          type: integer
          description: Unix timestamp of the last successful handshake
        rx_bytes:
          type: integer
          description: Total bytes received from the server since the last restart
        tx_bytes:
          type: integer
          description: Total bytes sent to the server since the last restart
        created_at:
          type: string
          format: date-time
          description: Client creation timestamp
        updated_at:
          type: string
          format: date-time
          description: Last update timestamp

    ServerConfig:
      type: object
      properties:
        external_ip:
          type: string
          format: ipv4
          description: External IP address
        external_port:
          type: integer
          description: External port number
        server_public_key:
          type: string
          description: Server public key
        subnet:
          type: string
          nullable: true
          description: Server subnet in CIDR format
        server_ip:
          type: string
          description: Server IP address
        enabled:
          type: boolean
          description: Whether WireGuard server is enabled
        obfuscation:
          type: boolean
          description: Whether obfuscation is enabled
        obfuscation_key:
          type: string
          description: Obfuscation key
        obfuscator_verbosity:
          type: string
          enum: [0, 1, 2, 3, 4]
          description: Obfuscator verbosity level
        masking_type:
          type: string
          enum: [none, obfs4, scramblesuit]
          description: Masking type
        masking_forced:
          type: boolean
          description: Whether masking type is forced for all clients

    ServerStatus:
      type: object
      properties:
        external_ip:
          type: string
          format: ipv4
        external_port:
          type: integer
        subnet:
          type: string
        server_ip:
          type: string
        server_public_key:
          type: string
        clients_count:
          type: integer
          description: Total number of clients
        connected_clients_count:
          type: integer
          description: Number of currently connected clients
        version:
          type: string
          description: Application version
        wireguard:
          type: object
          properties:
            running:
              type: boolean
            error:
              type: string
              nullable: true
        obfuscator:
          type: object
          properties:
            enabled:
              type: boolean
            running:
              type: boolean
            error:
              type: string
              nullable: true
            exit_code:
              type: integer
              nullable: true
            version:
              type: string
              nullable: true
              description: Obfuscator version

    WireGuardStats:
      type: object
      properties:
        interface:
          type: string
          description: WireGuard interface name
        peers:
          type: array
          items:
            $ref: '#/components/schemas/PeerStats'

    PeerStats:
      type: object
      properties:
        public_key:
          type: string
        client_name:
          type: string
          nullable: true
        endpoint:
          type: string
          nullable: true
        allowed_ips:
          type: string
        is_connected:
          type: boolean
        latest_handshake:
          type: integer
        transfer_rx_bytes:
          type: integer
          description: Bytes the client received from the server
        transfer_tx_bytes:
          type: integer
          description: Bytes the client sent to the server
        message:
          type: string
          nullable: true
          description: Optional status message (e.g., when client data is unavailable)

  responses:
    BadRequest:
      description: Bad request
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'

    Unauthorized:
      description: Unauthorized - missing or invalid authentication token
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'

    NotFound:
      description: Resource not found
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'

    InternalServerError:
      description: Internal server error
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'

